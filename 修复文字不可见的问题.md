# 游부 Lion OS - Troubleshooting Guide (Visibility & Blank Screens)

This document summarizes common issues where windows appear "blank" or "invisible" and their solutions.

## 1. The "Invisible Text" Issue (Dark Mode vs Light Mode)

### 游댮 The Problem
Text appears invisible or extremely faint.
*   **Cause**: The window `vibrancy` setting (e.g., `ultra-dark`, `under-window`) interacts with the system's Light Mode, causing the background to become light/transparent while the text remains some default color (often black) or white-on-light.
*   **Symptoms**: You see a glass pane, but no text. Or you see text but it's illegible.

### 游릭 The Solution (The "Nuclear" Fix)
We apply a two-layer fix to guarantee **White Text on Dark Glass**, regardless of system settings.

1.  **Electron Side (`main.js`)**:
    *   Use `vibrancy: 'hud'` instead of generic settings. 'hud' is designed for Heads-Up Displays and remains strictly dark/translucent even in Light Mode.

2.  **CSS Side (React Components)**:
    *   Force white text at the *root* container level using inline styles (stronger than CSS classes).
    *   Add `text-shadow` to ensure legibility even if the background fails to render correctly.

```jsx
// Example in YourComponent.jsx
<div style={{ 
    color: '#FFFFFF', 
    textShadow: '0 1px 2px rgba(0,0,0,0.9)', 
    fontSmoothing: 'antialiased' 
}}>
```

---

## 2. The "Empty Glass" Issue (Route Loading Failure)

### 游댮 The Problem
The window frame appears (glass effect works), but the content area is completely empty/transparent. No UI elements at all.

### 游릭 The Diagnosis
This usually means React failed to mount or the Electron window failed to load the URL.

*   **Check 1: Router Logic**: Does `App.jsx` have a case for this `windowType`?
    *   *Fix*: Ensure you added `if (windowType === 'new-feature') return <NewFeature />;`.
*   **Check 2: URL Parameters (Critical)**:
    *   Electron (`main.js`) sends: `?window=prompt-manager`
    *   React (`App.jsx`) looks for: `const type = params.get('window')`
    *   *Bug*: If one uses `?type=` and the other looks for `?window=`, `windowType` becomes null, and React renders `null` (nothing).

---

## 3. The "Not Allowed to Load Local Resource" Issue

### 游댮 The Problem
DevTools shows `Not allowed to load local resource: file:///Users/.../dist/index.html`.

### 游릭 The Diagnosis
This happens in **Development Mode** when `process.env.VITE_DEV_SERVER_URL` is undefined or incorrect. Electron falls back to loading the production build (`dist/index.html`), which:
1.  Might not exist yet.
2.  Is often blocked by security policies in dev mode if not configured.

### 游릭 The Solution
In `main.js`, explicitly check `!app.isPackaged` and force the localhost URL.

```javascript
// main.js
const isDev = !app.isPackaged;
const startUrl = isDev
    ? 'http://localhost:5173?window=your-window' // Force Localhost
    : `file://${path.join(__dirname, '../dist/index.html')}?window=your-window`;

win.loadURL(startUrl);
```

---

## 游 Shortcuts
*   **Open Developer Tools**: `Option + Command + I` (macOS) / `Ctrl + Shift + I` (Windows).
    *   *Note*: Works only if the window is focused.
